# Архитектура приложения

## Обзор

Приложение для обработки изображений построено по принципам архитектуры MVC (Model-View-Controller) с четким разделением ответственности между компонентами.

## Структура проекта

```
lab-1-cv/
├── main.py                 # Главный файл приложения
├── requirements.txt        # Зависимости Python
├── README.md              # Документация пользователя
├── ARCHITECTURE.md        # Документация архитектуры
├── test_app.py           # Тестовый скрипт
├── config/               # Конфигурация
│   ├── __init__.py
│   └── settings.py       # Настройки приложения
├── models/               # Модели данных и бизнес-логика
│   ├── __init__.py
│   ├── image_processor.py # Обработка изображений
│   └── image_analyzer.py  # Анализ изображений
├── views/                # Пользовательский интерфейс
│   ├── __init__.py
│   └── main_window.py    # Главное окно GUI
├── controllers/          # Контроллеры
│   ├── __init__.py
│   ├── gui_controller.py # Контроллер GUI
│   └── opencv_controller.py # Контроллер OpenCV
└── utils/                # Утилиты
    ├── __init__.py
    └── file_utils.py     # Работа с файлами
```

## Компоненты

### Models (Модели)

#### ImageProcessor
- **Назначение**: Основная бизнес-логика обработки изображений
- **Функции**:
  - Загрузка изображений
  - Применение эффектов (яркость, контраст, гамма, инверсия, отражения)
  - Перестановка каналов
  - Вычисление статистик пикселей

#### ImageAnalyzer
- **Назначение**: Анализ изображений и создание визуальных представлений
- **Функции**:
  - Создание гистограмм
  - Создание мозаики каналов
  - Создание увеличенных окон
  - Рисование рамок и статусной информации

### Views (Представления)

#### MainWindow
- **Назначение**: Современный GUI интерфейс на tkinter
- **Функции**:
  - Отображение изображений
  - Панель параметров с слайдерами
  - Информация о пикселях
  - Меню и кнопки управления

### Controllers (Контроллеры)

#### GUIController
- **Назначение**: Связывает GUI с бизнес-логикой
- **Функции**:
  - Обработка событий UI
  - Обновление отображения
  - Управление параметрами

#### OpenCVController
- **Назначение**: Классический OpenCV интерфейс
- **Функции**:
  - Управление окнами OpenCV
  - Обработка событий мыши и клавиатуры
  - Создание трекбаров

### Utils (Утилиты)

#### file_utils
- **Назначение**: Работа с файлами
- **Функции**:
  - Валидация путей к изображениям
  - Генерация имен файлов
  - Поддержка различных форматов

### Config (Конфигурация)

#### settings
- **Назначение**: Централизованное хранение настроек
- **Содержит**:
  - Константы размеров и цветов
  - Диапазоны параметров
  - Настройки GUI

## Потоки данных

### GUI режим
1. Пользователь изменяет параметры в UI
2. GUIController получает события
3. Параметры передаются в ImageProcessor
4. Изображение обрабатывается
5. Результат отображается в MainWindow

### OpenCV режим
1. Пользователь изменяет трекбары или нажимает клавиши
2. OpenCVController обрабатывает события
3. Параметры обновляются в ImageProcessor
4. Изображение обрабатывается
5. Результат отображается в окнах OpenCV

## Преимущества архитектуры

1. **Разделение ответственности**: Каждый компонент имеет четко определенную роль
2. **Модульность**: Компоненты слабо связаны и могут развиваться независимо
3. **Тестируемость**: Бизнес-логика изолирована от UI
4. **Расширяемость**: Легко добавлять новые эффекты или интерфейсы
5. **Поддерживаемость**: Код организован логично и документирован

## Расширение функциональности

### Добавление нового эффекта
1. Добавить параметр в `ImageProcessor.params`
2. Реализовать метод обработки в `ImageProcessor`
3. Добавить UI элемент в `MainWindow`
4. Обновить `GUIController` для обработки нового параметра

### Добавление нового интерфейса
1. Создать новый контроллер в `controllers/`
2. Реализовать методы управления UI
3. Добавить опцию запуска в `main.py`

## Тестирование

Приложение включает тестовый скрипт `test_app.py`, который проверяет:
- Загрузку и обработку изображений
- Создание гистограмм и мозаик
- Валидацию файлов
- Основную функциональность всех компонентов
